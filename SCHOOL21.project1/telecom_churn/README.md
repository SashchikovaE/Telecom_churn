# Telecom Churn Prediction

Проект по предсказанию оттока клиентов телеком-компании с использованием кастомной и sklearn-версии логистической регрессии.

## Содержание
- [Установка](#установка)
- [Структура проекта](#структура-проекта)
- [Данные](#данные)
- [Предобработка](#предобработка)
- [Модели](#модели)
- [Результаты](#результаты)
- [Как улучшить?](#как-улучшить)
- [Лицензия](#лицензия)

## Установка

### Вариант 1: С использованием Docker

1. **Установите Docker (если еще не установлен)**:
 - [Docker Desktop для Windows/Mac](https://www.docker.com/products/docker-desktop)
 - Для Linux: используйте пакетный менеджер вашего дистрибутива

2. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/SashchikovaE/Telecom_churn.git
   cd projects/telecom_churn
   ```

3. **Соберите и запустите контейнер**:
    ```bash
   docker build -t telecom-churn .
   docker run telecom-churn
   ```
   
### Вариант 2: Без использования Docker

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/SashchikovaE/Telecom_churn.git
   cd projects/telecom_churn
   ```

2. **Создайте виртуальное окружение**:
    ``` bash
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   venv\Scripts\activate     # Windows
   ```

2. **Установите зависимости**:
    ``` bash
   pip install -r requirements.txt
   ```
   
3. **Запустите проект**:
    ``` bash
   python main.py
   ```

## Структура проекта
```
telecom_churn/
├── data/                                  # Исходные данные
│   └── telecom.csv          
├── models/                                # Модель
│   └── log_regression_original.joblib
├── src/
│   ├── images
│   ├── preprocessing.py                   # Предобработка данных
│   ├── logistic_regression_custom.py      # Кастомная логистическая регрессия
│   ├── logistic_regression_original.py    # Sklearn логистическая регрессия
│   ├── random_forest_original.py          # Sklearn случайный лес
│   ├── random_forest_custom.py            # Кастомный случайный лес
│   └── main.py                            # Точка входа
├── api.py                                 # Приложение
├── templates/                             # Формы для приложения
│   ├── form.html
│   └── index.html  
├── Dockerfile                             # Докер файл
├── requirements.txt                       # Требования
├── tests.py                               # Тесты
└── README.md
```

## Данные

[Датасет с Kaggle](https://www.kaggle.com/datasets/blastchar/telco-customer-churn) содержит информацию о клиентах телеком-компании:

- Целевая переменная: Churn (1/0)
- Признаки
    - Платежи (Ежемесячные/Общие расходы)
    - Услуги (Интернет, ТВ и т.д.)
    - Демографические (пол, семейное положение и т.д.)
  
## Предобработка

В качестве предобработки данных мною было выполнено:
- Кодирование категориальных данных
- Преобразование object столбцов в численные
- Обработка пустых ячеек
- Анализ и визуализация выбросов
- Добавление новых признаков
- Z-score нормализация данных
- Визуализация распределения churn 

![churn](src/images/churn_distribution.png)
- Построение матрицы корреляций 
 
![матрицы корреляций](src/images/correlation_matrix.png)

## Модели

### Кастомная логистическая регрессия
Была реализована с нуля
- Функция логистической регрессии
- Метрики accuracy, precision, recall, f1
- Кросс-валидация
- Реализация подбора параметров в конструкторе класса

### Sklearn логистическая регрессия
Используется для сравнения

## Результаты

| Метрика   | Кастомная | Sklearn | Кастомная cv | Sklearn cv |
|-----------|-----------|---------|--------------|------------|
| Accuracy  | 0.8162    | 0.7437  | 0.7997       | 0.7471     |
| Precision | 0.6939    | 0.5109  | 0.6604       | 0.5148     |
| Recall    | 0.5470    | 0.8168  | 0.5038       | 0.8023     |
| F1        | 0.6117    | 0.6286  | 0.5706       | 0.6268     |
| ROC-AUC   | 0.7300    | 0.7671  | 0.7051       | 0.7647     |

### Выводы
- В случае если нам нужно гарантированно удержать клиентов, 
используем кастомную модель со стандартным разделением данных,
так как метрика precision именно этой модели показывает
наибольший результат
- Если компания готова предоставлять скидки клиентам, 
которые фактически не уходят (ложноположительные случаи, 
а это 19%), стоит выбрать sklearn-версию модели с высоким 
recall
- Кастомная версия показала лучшие результаты метрик accuracy, 
precision
- Но в целом, лучшие результаты метрик показала sklearn версия со стандартным
сплитом.

## Как улучшить?

- Добавление unit-тестов
- Добавление кастомной модели RandomForest
- Разобраться с api

## Лицензия
Этот проект распространяется под лицензией MIT. Вы можете 
свободно использовать, изменять и распространять его при условии 
сохранения уведомления об авторстве.~~
